<!DOCTYPE html>
<html lang="es">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DATOS COMPARTIDOS</title>
    <link rel="icon" href="favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
    <link rel="stylesheet" href="estilos.css">
</head>
<body>
<div class="header">
    <img src="logo.png" alt="Logo de la empresa" class="logo">
    <h1>DATOS COMPARTIDOS</h1>
    <a href="Pagina%20principal.html"><i class="fas fa-home"></i> Página Principal</a>
    <a href="Merma.html"><i class="fas fa-trash"></i> MERMA</a>
    <a href="Consumo%20de%20Papel.html"><i class="fas fa-file"></i> CONSUMO DE PAPEL</a>
    <a href="Produccion%20Diaria%20de%20Maquinas.html"><i class="fas fa-cog"></i> PRODUCCION DIARIA DE MAQUINAS</a>
    <a href="Reporte%20Diario.html"><i class="fas fa-file"></i> REPORTE DIARIO</a>
</div>
<h1>DATOS COMPARTIDOS</h1>

<!-- Tabla para la categoría "ONIMEX" -->
<div class="table-container">
    <h2>ONIMEX</h2>
    <table class="table" id="onimex-table">
        <thead>
            <tr>
                <th>FILA</th>
                <th>MAQUINA</th>
                <th>BOLSA/CLIENTE</th>
                <th>KILOS 1T</th>
                <th>MILLARES 1T</th>
                <th>KILOS 2T</th>
                <th>MILLARES 2T</th>
                <th>TOTAL EN MILLARES (1T+2T)</th>
                <th>TOTAL FABRICADO DE LA O.F.</th>
                <th>OBSERVACIONES</th>
            </tr>
        </thead>
        <tbody>
            <!-- Generar 100 filas -->
            <!-- Puedes hacer esto manualmente o con un bucle en JavaScript -->
            <!-- Aquí se muestra una fila de ejemplo, repite esto 99 veces -->
            <tr>
                <td>1</td>
                <td><input type="text" name="onimex_maquina_1" placeholder="Maquina"></td>
                <td><input type="text" name="onimex_bolsa_1" placeholder="Bolsa/Cliente"></td>
                <td><input type="text" name="onimex_kilos1T_1" placeholder="Kilos 1T"></td>
                <td><input type="text" name="onimex_millares1T_1" placeholder="Millares 1T"></td>
                <td><input type="text" name="onimex_kilos2T_1" placeholder="Kilos 2T"></td>
                <td><input type="text" name="onimex_millares2T_1" placeholder="Millares 2T"></td>
                <td><input type="text" name="onimex_totalMillares_1" placeholder="Total en Millares"></td>
                <td><input type="text" name="onimex_totalFabricado_1" placeholder="Total Fabricado"></td>
                <td><input type="text" name="onimex_observaciones_1" placeholder="Observaciones"></td>
            </tr>
            <!-- Repetir esta fila 99 veces -->
            <!-- Añadir filas de forma dinámica con JavaScript -->
        </tbody>
    </table>
    <button class="button" onclick="agregarFila('onimex-table')">Agregar Fila</button>
</div>

<!-- Tabla para la categoría "LA LAGUNA" -->
<div class="table-container">
    <h2>LA LAGUNA</h2>
    <table class="table" id="la-laguna-table">
        <thead>
            <tr>
                <th>FILA</th>
                <th>MAQUINA</th>
                <th>BOLSA/CLIENTE</th>
                <th>KILOS 1T</th>
                <th>MILLARES 1T</th>
                <th>KILOS 2T</th>
                <th>MILLARES 2T</th>
                <th>TOTAL EN MILLARES (1T+2T)</th>
                <th>TOTAL FABRICADO DE LA O.F.</th>
                <th>OBSERVACIONES</th>
            </tr>
        </thead>
        <tbody>
            <!-- Generar 100 filas -->
            <!-- Puedes hacer esto manualmente o con un bucle en JavaScript -->
            <!-- Aquí se muestra una fila de ejemplo, repite esto 99 veces -->
            <tr>
<td>1</td>
                <td><input type="text" name="la_laguna_maquina_1" placeholder="Maquina"></td>
                <td><input type="text" name="la_laguna_bolsa_1" placeholder="Bolsa/Cliente"></td>
                <td><input type="text" name="la_laguna_kilos1T_1" placeholder="Kilos 1T"></td>
                <td><input type="text" name="la_laguna_millares1T_1" placeholder="Millares 1T"></td>
                <td><input type="text" name="la_laguna_kilos2T_1" placeholder="Kilos 2T"></td>
                <td><input type="text" name="la_laguna_millares2T_1" placeholder="Millares 2T"></td>
                <td><input type="text" name="la_laguna_totalMillares_1" placeholder="Total en Millares"></td>
                <td><input type="text" name="la_laguna_totalFabricado_1" placeholder="Total Fabricado"></td>
                <td><input type="text" name="la_laguna_observaciones_1" placeholder="Observaciones"></td>
            </tr>
            <!-- Repetir esta fila 99 veces -->
            <!-- Añadir filas de forma dinámica con JavaScript -->
        </tbody>
    </table>
    <button class="button" onclick="agregarFila('la-laguna-table')">Agregar Fila</button>
</div>

<!-- Tabla para la categoría "APSA" -->
<div class="table-container">
    <h2>APSA</h2>
    <table class="table" id="apsa-table">
        <thead>
            <tr>
                <th>FILA</th>
                <th>MAQUINA</th>
                <th>BOLSA/CLIENTE</th>
                <th>KILOS 1T</th>
                <th>MILLARES 1T</th>
                <th>KILOS 2T</th>
                <th>MILLARES 2T</th>
                <th>TOTAL EN MILLARES (1T+2T)</th>
                <th>TOTAL FABRICADO DE LA O.F.</th>
                <th>OBSERVACIONES</th>
            </tr>
        </thead>
        <tbody>
            <!-- Generar 100 filas -->
            <!-- Puedes hacer esto manualmente o con un bucle en JavaScript -->
            <!-- Aquí se muestra una fila de ejemplo, repite esto 99 veces -->
            <tr>
               <td>1</td> 	
                <td><input type="text" name="apsa_maquina_1" placeholder="Maquina"></td>
                <td><input type="text" name="apsa_bolsa_1" placeholder="Bolsa/Cliente"></td>
                <td><input type="text" name="apsa_kilos1T_1" placeholder="Kilos 1T"></td>
                <td><input type="text" name="apsa_millares1T_1" placeholder="Millares 1T"></td>
                <td><input type="text" name="apsa_kilos2T_1" placeholder="Kilos 2T"></td>
                <td><input type="text" name="apsa_millares2T_1" placeholder="Millares 2T"></td>
                <td><input type="text" name="apsa_totalMillares_1" placeholder="Total en Millares"></td>
                <td><input type="text" name="apsa_totalFabricado_1" placeholder="Total Fabricado"></td>
                <td><input type="text" name="apsa_observaciones_1" placeholder="Observaciones"></td>
            </tr>
            <!-- Repetir esta fila 99 veces -->
            <!-- Añadir filas de forma dinámica con JavaScript -->
        </tbody>
    </table>
    <button class="button" onclick="agregarFila('apsa-table')">Agregar Fila</button>
</div>

<!-- Botón para guardar Excel -->
<button class="button" onclick="guardarExcel()"><i class="fas fa-file-excel"></i> Guardar Excel</button>

<script>

    // Define un objeto para mantener un seguimiento de las filas de cada tabla
    const filasPorTabla = {};

    function agregarFila(tableId) {
        const table = document.getElementById(tableId).getElementsByTagName('tbody')[0];
        const newRow = table.insertRow(table.rows.length);

        newRow.innerHTML = `<td>${table.rows.length}</td>
                            <td><input type="text" name="${tableId}_maquina_${table.rows.length}" placeholder="Maquina"></td>
                            <td><input type="text" name="${tableId}_bolsa_${table.rows.length}" placeholder="Bolsa/Cliente"></td>
                            <td><input type="text" name="${tableId}_kilos1T_${table.rows.length}" placeholder="Kilos 1T"></td>
                            <td><input type="text" name="${tableId}_millares1T_${table.rows.length}" placeholder="Millares 1T"></td>
                            <td><input type="text" name="${tableId}_kilos2T_${table.rows.length}" placeholder="Kilos 2T"></td>
                            <td><input type="text" name="${tableId}_millares2T_${table.rows.length}" placeholder="Millares 2T"></td>
                            <td><input type="text" name="${tableId}_totalMillares_${table.rows.length}" placeholder="Total en Millares"></td>
                            <td><input type="text" name="${tableId}_totalFabricado_${table.rows.length}" placeholder="Total Fabricado"></td>
                            <td><input type="text" name="${tableId}_observaciones_${table.rows.length}" placeholder="Observaciones"></td>`;

        // Guarda la fila en el objeto filasPorTabla
        if (!filasPorTabla[tableId]) {
            filasPorTabla[tableId] = [];
        }
        filasPorTabla[tableId].push(newRow);
    }

    // Agregar 100 filas automáticamente al cargar la página
    document.addEventListener('DOMContentLoaded', function () {
        for (let i = 1; i <= 100; i++) {
            agregarFila('onimex-table');
            agregarFila('la-laguna-table');
            agregarFila('apsa-table');
        }
    });
 

    function guardarExcel() {
        const wb = XLSX.utils.book_new();

        for (const tableId in filasPorTabla) {
            const table = document.getElementById(tableId);
            const sheetName = tableId;
            const ws = XLSX.utils.aoa_to_sheet([]); // Crear una hoja de cálculo vacía

            const headerRow = table.querySelector('thead tr');
            const headerData = [];
            headerRow.querySelectorAll('th').forEach(th => {
                headerData.push(th.innerText);
            });
            XLSX.utils.sheet_add_aoa(ws, [headerData], { origin: 'A1' }); // Agregar encabezados en A1

            // Obtén las filas de la tabla desde el objeto filasPorTabla
            const rows = filasPorTabla[tableId];
            const dataToSave = [];

            rows.forEach(row => {
                const rowData = [];
                const cells = row.querySelectorAll('input');
                cells.forEach(cell => {
                    rowData.push(cell.value);
                });
                dataToSave.push(rowData);
            });

            // Agregar todos los registros debajo de los encabezados
            XLSX.utils.sheet_add_aoa(ws, dataToSave, { origin: 'A2' });

            XLSX.utils.book_append_sheet(wb, ws, sheetName);
        }

        XLSX.writeFile(wb, 'datos_compartidos.xlsx');
    }
</script>
</body>
</html>