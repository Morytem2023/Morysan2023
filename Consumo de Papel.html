<!DOCTYPE html>
<html lang="es">
<head>
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CONSUMO DE PAPEL</title>
    <link rel="icon" href="favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">   
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
    <link rel="icon" href="favicon.png" type="image/x-icon"> 
    <link rel="stylesheet" href="estilos.css">
</head>
<body>
    <!-- Encabezado -->
    <div class="header">
        <img src="logo.png" alt="Logo de la empresa" class="logo">
        <h1>CONSUMO DE PAPEL</h1>
        
<a href="Pagina%20principal.html"><i class="fas fa-home"></i> Página Principal</a>
        <a href="Reporte%20Diario.html"><i class="fas fa-file"></i> REPORTE DIARIO</a>
         <a href="Produccion%20Diaria%20de%20Maquinas.html"><i class="fas fa-cog"></i> PRODUCCION DIARIA DE MAQUINAS</a>
        <a href="Merma.html"><i class="fas fa-trash"></i> Merma</a>
        <a href="COMPARTIDOS.html"><i class="fas fa-share-alt"></i> DATOS COMPARTIDOS</a>
    </div>
    <h1>CONSUMO DE PAPEL</h1>


<!-- Tabla para la categoría "ONIMEX" -->
<div class="table-container">
    <h2>ONIMEX</h2>
    <table class="table" id="onimex-table">
        <thead>
            <tr>
                <th>FILA</th>
                <th>FECHA</th>
                <th>MAQUINA</th>
                <th>BOLSA</th>
                <th>KILOS</th>
                <th>KILOS TRANSFORMADOS</th>
                <th>TOTAL DE KILOS POR MILLAR</th>
                <th>1ER TURNO MILLARES</th>
                <th>2DO TURNO MILLARES</th>
                <th>TOTAL EN MILLARES</th>
                <th>OBSERVACIONES</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td><input type="text" name="onimex_fecha_1" placeholder="Fecha"></td>
                <td><input type="text" name="onimex_maquina_1" placeholder="Maquina"></td>
                <td><input type="text" name="onimex_bolsa_1" placeholder="Bolsa"></td>
                <td><input type="text" name="onimex_kilos_1" placeholder="Kilos"></td>
                <td><input type="text" name="onimex_kilost_1" placeholder="Kilos Transformados"></td>
                <td><input type="text" name="onimex_totalkilosm_1" placeholder="Total de kilos por millar"></td>
                <td><input type="text" name="onimex_1turnom" placeholder="1er Turno Millares"></td>
                <td><input type="text" name="onimex_2turnom" placeholder="2do Turno Millares"></td>
                <td><input type="text" name="onimex_totalm_1" placeholder="Total En Millares"></td>
                <td><input type="text" name="onimex_observaciones_1" placeholder="Observaciones"></td>
            </tr>
            <!-- Repetir esta fila 99 veces -->
            <!-- Añadir filas de forma dinámica con JavaScript -->
        </tbody>
    </table>
    <button class="button" onclick="agregarFila('onimex-table')">Agregar Fila</button>
</div>

<!-- Tabla para la categoría "LA LAGUNA" -->
<div class="table-container">
    <h2>LA LAGUNA</h2>
    <table class="table" id="la-laguna-table">
        <thead>
            <tr>
                <th>FILA</th>
                <th>FECHA</th>
                <th>MAQUINA</th>
                <th>BOLSA</th>
                <th>KILOS</th>
                <th>KILOS TRANSFORMADOS</th>
                <th>TOTAL DE KILOS POR MILLAR</th>
                <th>1ER TURNO MILLARES</th>
                <th>2DO TURNO MILLARES</th>
                <th>TOTAL EN MILLARES</th>
                <th>OBSERVACIONES</th>
            </tr>
        </thead>
        <tbody>
            <!-- Generar 100 filas -->
            <!-- Puedes hacer esto manualmente o con un bucle en JavaScript -->
            <!-- Aquí se muestra una fila de ejemplo, repite esto 99 veces -->
            <tr>
                <td>1</td>
                <td><input type="text" name="la_laguna_fecha_1" placeholder="Fecha"></td>
                <td><input type="text" name="la_laguna_maquina_1" placeholder="Maquina"></td>
                <td><input type="text" name="la_laguna_bolsa_1" placeholder="Bolsa"></td>
                <td><input type="text" name="la_laguna_kilos_1" placeholder="Kilos"></td>
                <td><input type="text" name="la_laguna_kilost_1" placeholder="Kilos Transformados"></td>
                <td><input type="text" name="la_laguna_totalkilosm_1" placeholder="Total de kilos por millar"></td>
                <td><input type="text" name="la_laguna_1turnom" placeholder="1er Turno Millares"></td>
                <td><input type="text" name="la_laguna_2turnom" placeholder="2do Turno Millares"></td>
                <td><input type="text" name="la_laguna_totalm_1" placeholder="Total En Millares"></td>
                <td><input type="text" name="la_laguna_observaciones_1" placeholder="Observaciones"></td>
            <!-- Repetir esta fila 99 veces -->
            <!-- Añadir filas de forma dinámica con JavaScript -->
        </tbody>
    </table>
    <button class="button" onclick="agregarFila('la-laguna-table')">Agregar Fila</button>
</div>

<!-- Tabla para la categoría "APSA" -->
<div class="table-container">
    <h2>APSA</h2>
    <table class="table" id="apsa-table">
        <thead>
            <tr>
                <th>FILA</th>
                <th>FECHA</th>
                <th>MAQUINA</th>
                <th>BOLSA</th>
                <th>KILOS</th>
                <th>KILOS TRANSFORMADOS</th>
                <th>TOTAL DE KILOS POR MILLAR</th>
                <th>1ER TURNO MILLARES</th>
                <th>2DO TURNO MILLARES</th>
                <th>TOTAL EN MILLARES</th>
                <th>OBSERVACIONES</th>
            </tr>
        </thead>
        <tbody>
            <!-- Generar 100 filas -->
            <!-- Puedes hacer esto manualmente o con un bucle en JavaScript -->
            <!-- Aquí se muestra una fila de ejemplo, repite esto 99 veces -->
            <tr>
                <td>1</td>
                <td><input type="text" name="apsa_fecha_1" placeholder="Fecha"></td>
                <td><input type="text" name="apsa_maquina_1" placeholder="Maquina"></td>
                <td><input type="text" name="apsa_bolsa_1" placeholder="Bolsa"></td>
                <td><input type="text" name="apsa_kilos_1" placeholder="Kilos"></td>
                <td><input type="text" name="apsa_kilost_1" placeholder="Kilos Transformados"></td>
                <td><input type="text" name="apsa_totalkilosm_1" placeholder="Total de kilos por millar"></td>
                <td><input type="text" name="apsa_1turnom" placeholder="1er Turno Millares"></td>
                <td><input type="text" name="apsa_2turnom" placeholder="2do Turno Millares"></td>
                <td><input type="text" name="apsa_totalm_1" placeholder="Total En Millares"></td>
                <td><input type="text" name="apsa_observaciones_1" placeholder="Observaciones"></td>
            </tr>
            <!-- Repetir esta fila 99 veces -->
            <!-- Añadir filas de forma dinámica con JavaScript -->
        </tbody>
    </table>
    <button class="button" onclick="agregarFila('apsa-table')">Agregar Fila</button>
</div>

<!-- Botón para guardar Excel -->
<button class="button" onclick="guardarExcel()"><i class="fas fa-file-excel"></i> Guardar Excel</button>

<script>

    // Define un objeto para mantener un seguimiento de las filas de cada tabla
    const filasPorTabla = {};

    function agregarFila(tableId) {
        const table = document.getElementById(tableId).getElementsByTagName('tbody')[0];
        const newRow = table.insertRow(table.rows.length);

        newRow.innerHTML = `<td>${table.rows.length}</td>
                            <td><input type="text" name="${tableId}_fecha_${table.rows.length}" placeholder="Fecha"></td>
                            <td><input type="text" name="${tableId}_maquina_${table.rows.length}" placeholder="Maquina"></td>
                            <td><input type="text" name="${tableId}_bolsa_${table.rows.length}" placeholder="Bolsa"></td>
                            <td><input type="text" name="${tableId}_kilos_${table.rows.length}" placeholder="Kilos"></td>
                            <td><input type="text" name="${tableId}_kilosT_${table.rows.length}" placeholder="Kilos Transformados"></td>
                            <td><input type="text" name="${tableId}_totalkilosm_${table.rows.length}" placeholder="Total de kilos por millar"></td>
                            <td><input type="text" name="${tableId}_1turnom_${table.rows.length}" placeholder="1er Turno Millares"></td>
                            <td><input type="text" name="${tableId}_2turnom_${table.rows.length}" placeholder="2do Turno Millares"></td>
                            <td><input type="text" name="${tableId}_totalm_${table.rows.length}" placeholder="Total En Millares"></td>
                            <td><input type="text" name="${tableId}_observaciones_${table.rows.length}" placeholder="Observaciones"></td>`;
        // Guarda la fila en el objeto filasPorTabla
        if (!filasPorTabla[tableId]) {
            filasPorTabla[tableId] = [];
        }
        filasPorTabla[tableId].push(newRow);
    }

    // Agregar 100 filas automáticamente al cargar la página
    document.addEventListener('DOMContentLoaded', function () {
        for (let i = 1; i <= 100; i++) {
            agregarFila('onimex-table');
            agregarFila('la-laguna-table');
            agregarFila('apsa-table');
        }
    });
 

    function guardarExcel() {
        const wb = XLSX.utils.book_new();

        for (const tableId in filasPorTabla) {
            const table = document.getElementById(tableId);
            const sheetName = tableId;
            const ws = XLSX.utils.aoa_to_sheet([]); // Crear una hoja de cálculo vacía

            const headerRow = table.querySelector('thead tr');
            const headerData = [];
            headerRow.querySelectorAll('th').forEach(th => {
                headerData.push(th.innerText);
            });
            XLSX.utils.sheet_add_aoa(ws, [headerData], { origin: 'A1' }); // Agregar encabezados en A1

            // Obtén las filas de la tabla desde el objeto filasPorTabla
            const rows = filasPorTabla[tableId];
            const dataToSave = [];

            rows.forEach(row => {
                const rowData = [];
                const cells = row.querySelectorAll('input');
                cells.forEach(cell => {
                    rowData.push(cell.value);
                });
                dataToSave.push(rowData);
            });

            // Agregar todos los registros debajo de los encabezados
            XLSX.utils.sheet_add_aoa(ws, dataToSave, { origin: 'A2' });

            XLSX.utils.book_append_sheet(wb, ws, sheetName);
        }

        XLSX.writeFile(wb, 'consumo_de_papel.xlsx');
    }
</script>
</body>
</html>